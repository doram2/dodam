package springBootTest2.service.goods;

import java.io.File;

import javax.servlet.http.HttpSession;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;
import org.springframework.stereotype.Service;
import org.springframework.ui.Model;

import springBootTest2.mapper.Goods1Mapper;

@Component
@Service
public class GoodsDeleteService {
	@Autowired
	Goods1Mapper goods1Mapper;
	public void execute(String goodsNum, HttpSession session, Model model) {
		GoodsDTO dto = goods1Mapper.selectOne(goodsNum);
		Integer i = goods1Mapper.goodsDelete(goodsNum);
		if(i > 0 && dto.getStoreFileName() != null) {
			String[] fileNames = dto.getStoreFileName().split("`");
			String filePath = "/view/lib";
			String fileDir = session.getServletContext().getRealPath(filePath);
			File file = null;
			try {
				for(String fileName : fileNames) {
					file = new File(fileDir + "/" + fileName);
					if(file.exists()) file.delete();
				}
			} catch (Exception e) {}
		}
		path = "redirect:libList";
	}
}
