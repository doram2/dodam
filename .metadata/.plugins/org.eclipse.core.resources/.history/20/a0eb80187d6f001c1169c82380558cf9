package model.DAO;

import model.DTO.GoodsDTO;

public class GoodsDAO extends DataBaseInfo {
	final String COLUMNS = "  goods_num,  goods_name , goods_price, goods_date, goods_content "
			+ "  goods_images, goods_qty , goods_company,  emp_num  , " + "  ip_addr ";
	String sql;

	public void goodsInsert(GoodsDTO dto) {
		con = getConnection();
		sql = "  insert into goods(  " + COLUMNS + ") " + "   values(?,?,?,?,?,?,?,?,?,?)  ";
		try {
			pstmt = con.prepareStatement(sql);
			pstmt.setString(1, dto.getEmpNum());
			pstmt.setString(2, dto.getGoodsName());
			pstmt.setInt(3, dto.getGoodsPrice());
			pstmt.setTimestamp(4, dto.getGoodsDate());
			pstmt.setString(5, dto.getGoodsContent());
			pstmt.setString(6, dto.getGoodsImages());
			pstmt.setInt(7, dto.getGoodsQty());
			pstmt.setString(8, dto.getGoodsCompany());
			pstmt.setString(9, dto.getEmpNum());
			pstmt.setString(10, dto.getIpAddr());
			int i = pstmt.executeUpdate();
			System.out.println(i + " 개의 행이(가) 모행는대요?");
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			close();
		}
	}

	public int autoNum() {
		int i = 0;
		con = getConnection();
		sql = "select seq_num.nextval from dual";
		try {
			pstmt = con.prepareStatement(sql);
			rs = pstmt.executeQuery();
			if (rs.next()) {
				i = rs.getInt(1);
			}
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			close();
		}
		return i;
	}
}
